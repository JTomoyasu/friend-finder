<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <title>Survey</title>
    <style>
        .modal {
            /*Taken from w3schools: https://www.w3schools.com/howto/howto_css_modals.asp */
            display: none;
            position: fixed;
            z-index: 1;
            padding-top: 100px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.4);
        }
    </style>
</head>

<body>
    <div id="friendMatch" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="close">&times;</span>
                <h1>Here's your match: </h1>
                <h2 id="friendName">Name: </h2>
                <img src="" alt="" id="friendImg">
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-lg-10">
                <h1>Survey Questions</h1>
                <form role="form" class="needs-validation" novalidate>
                    <div class="form-group">
                        <label for="user-name">Name (required)</label>
                        <input type="text" class="form-control" id="user-name" required>
                        <div class="inv">
                            Please choose a name.
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="photo-link">Photo Link (required)</label>
                        <input type="text" class="form-control" id="photo-link" required>
                        <div class="inv">
                            Please provide a photo.
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Question1">Question 1: Would you call yourself a people person?</label>
                        <select class="form-control" id="Question1">
                            <option>1 Strongly Disagree</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 Strongly Agree</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Question2">Question 2: Do you often make long term plans?</label>
                        <select class="form-control" id="Question2">
                            <option>1 Strongly Disagree</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 Strongly Agree</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Question3">Question 3: Do you prefer fitting into a set structure or making your own?</label>
                        <select class="form-control" id="Question3">
                            <option>1 Strongly Disagree</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 Strongly Agree</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Question4">Question 4: Do you often find yourself lost in thought?</label>
                        <select class="form-control" id="Question4">
                            <option>1 Strongly Disagree</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 Strongly Agree</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Question5">Question 5: Do you find it difficult to relate to people?</label>
                        <select class="form-control" id="Question5">
                            <option>1 Strongly Disagree</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 Strongly Agree</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Question6">Question 6: Do you prefer known quantities to surprises?</label>
                        <select class="form-control" id="Question6">
                            <option>1 Strongly Disagree</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 Strongly Agree</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Question7">Question 7: Do you think that flying would be a better superpower than invisibility?</label>
                        <select class="form-control" id="Question7">
                            <option>1 Strongly Disagree</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 Strongly Agree</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Question8">Question 8: Would you say that you're a problem solver?</label>
                        <select class="form-control" id="Question8">
                            <option>1 Strongly Disagree</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 Strongly Agree</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Question9">Question 9: Do you think that it's better to be hot than to be cold?</label>
                        <select class="form-control" id="Question9">
                            <option>1 Strongly Disagree</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 Strongly Agree</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Question10">Question 10: Do you consider world domination a valid cure for the world's ails?</label>
                        <select class="form-control" id="Question10">
                            <option>1 Strongly Disagree</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 Strongly Agree</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary submit">Submit</button>
                </form>
            </div>
        </div>
    </div>
</body>
<script type="text/javascript">
    $(".close").on("click", function (event) {
        document.getElementById("friendMatch").style.display = "none";
    });
    window.onclick = function (event) {
        if (event.target == document.getElementById("friendMatch")) {
            document.getElementById("friendMatch").style.display = "none";
        }
    }
    $(".submit").on("click", function (event) {
        event.preventDefault();
        if ($("#user-name").val()==""||$("#photo-link").val()=="") {
            alert("Please input a name and photo link")
        }
        else {
            var userScores = [
                $("#Question1").val().trim(),
                $("#Question2").val().trim(),
                $("#Question3").val().trim(),
                $("#Question4").val().trim(),
                $("#Question5").val().trim(),
                $("#Question6").val().trim(),
                $("#Question7").val().trim(),
                $("#Question8").val().trim(),
                $("#Question9").val().trim(),
                $("#Question10").val().trim()
            ];
            for (i = 0; userScores.length > i; i++) {
                if (isNaN(userScores[i])) {
                    if (userScores[i].length > 2) {
                        userScores[i] = userScores[i].substring(0, userScores[i].indexOf("S"));
                        userScores[i].trim();
                        userScores[i] = parseInt(userScores[i]);
                    }
                }
            }
            var newUser = {
                name: $("#user-name").val().trim(),
                photo: $("#photo-link").val().trim(),
                scores: userScores
            }
            $.post("/api/friends", newUser, function (data) {
                $("#friendName").text("Name: "+data.name);
                $("#friendImg").attr("src", data.photo);
                document.getElementById("friendMatch").style.display = "block";
                $("#user-name").val("");
                $("#photo-link").val("");
            })
        }
    })
</script>

</html>